# 从POLARDB for MySQL迁移至POLARDB for MySQL {#concept_d1p_4zn_v2b .concept}

本文介绍如何使用[数据传输服务（DTS）](https://help.aliyun.com/document_detail/26592.html)将一个POLARDB集群的数据迁移到另一个POLARDB集群。本迁移操作免费。

## 前提条件 {#section_e5z_1rk_xdb .section}

**为源集群设置IP白名单**

迁移前，您需要为源POLARDB集群设置IP白名单。操作如下：

1.  进入[POLARDB控制台](https://polardb.console.aliyun.com/)。
2.  选择地域。
3.  找到目标集群，单击集群名称列的**集群ID**。
4.  在访问信息区域，单击白名单列表后面的**配置**，在弹出的对话框中添加DTS的IP段。

    |地域|需要添加到POLARDB白名单的IP段|
    |--|-------------------|
    |华东1（杭州）|101.37.14.0/24,114.55.89.0/24,115.29.198.0/24,118.178.120.0/24,118.178.121.0/24,120.26.106.0/24,120.26.116.0/24,120.26.117.0/24,120.26.118.0/24,120.55.192.0/24,120.55.193.0/24,120.55.194.0/24,120.55.241.0/24,121.40.125.0/24,121.196.246.0/24,101.37.12.0/24,101.37.13.0/24,101.37.15.0/24,101.37.25.0/24,47.96.39.0/24,118.31.184.0/24,118.31.165.0/24,118.31.246.0/24,120.55.12.0/24,47.97.7.0/24,120.55.129.0/24|
    |华东2（上海）|139.196.17.0/24,139.196.18.0/24,139.196.25.0/24,139.196.27.0/24,139.196.154.0/24,139.196.116.0/24,139.196.254.0/24,139.196.166.0/24,106.14.46.0/24,106.14.37.0/24,106.14.36.0/24,106.15.250.0/24,101.132.248.0/24,47.100.95.0/24,120.55.129.0/24|
    |华北2（北京）|112.126.80.0/24,112.126.87.0/24,112.126.91.0/24,112.126.92.0/24,123.56.108.0/24,123.56.120.0/24,123.56.137.0/24,123.56.148.0/24,123.56.164.0/24,123.57.48.0/24,182.92.153.0/24,182.92.186.0/24,101.200.174.0/24,101.200.160.0/24,101.200.176.0/24,47.94.36.0/24,47.94.47.0/24,101.201.214.0/24,101.201.82.0/24,120.55.129.0/24|


**创建数据库账号**

迁移前，您需要为源POLARDB集群和目的POLARDB集群创建数据库账号。您可以创建高权限账号，具体操作请参考[创建集群高权限账号](cn.zh-CN/POLARDB for MySQL快速入门/创建数据库账号.md)。

**停止数据写入**

为保证迁移数据一致性，在开始迁移前，需停止写入数据到源集群。

## 迁移步骤 {#section_yww_nrk_xdb .section}

1.  进入[DTS控制台](https://dts.console.aliyun.com/)。
2.  在左侧导航栏选择**数据迁移**，然后在右上角单击**创建迁移任务**。
3.  （可选）填写任务名称。

    DTS 为每个任务自动生成一个任务名称，任务名称没有唯一性要求。您可以根据需要修改任务名称，建议为任务配置具有业务意义的名称，便于后续的任务识别。

4.  填写源集群的信息。

    -   实例类型：选择**有公网IP的自建数据库**
    -   实例地区：选择POLARDB所集群在的地域。
    -   数据库类型：选择 **MySQL**。
    -   主机名或IP地址：输入POLARDB集群的公网集群地址。您可以参考[查看连接地址](cn.zh-CN/POLARDB for MySQL快速入门/连接数据库集群/查看连接地址.md)。
    -   端口：输入3306
    -   数据库账号：POLARDB集群数据库的账号。
    -   数据库密码：以上账号的密码。
    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/17772/15574814959778_zh-CN.png)

5.  单击**测试连接**，确认DTS可以连接到源POLARDB集群。
6.  填写目标集群的信息。
    -   实例类型：选择**POLARDB**
    -   实例地区：选择目标集群所在的地域。
    -   POLARDB实例ID：输入POLARDB集群的ID。
    -   数据库账号：POLARDB集群的账号。
    -   数据库密码：以上账号的密码。
7.  单击**测试连接**，确认DTS可以连接到目标POLARDB集群。
8.  单击右下角的**授权白名单并进入下一步**。
9.  选择**迁移类型**和**迁移对象**。
    -   **迁移类型**：选择**结构迁移**和**全量数据迁移**。（暂不支持增量迁移。）为保证迁移数据一致性，在开始迁移前，需停止写入数据到源集群。
        -   结构迁移

            DTS 会将迁移对象的结构定义迁移到目标集群。目前 DTS 支持结构迁移的对象包括：表。其他对象如视图、同义词、触发器、存储过程、存储函数、包、自定义类型等暂不支持。

        -   全量数据迁移

            DTS 会将源数据库迁移对象的存量数据全部迁移到目标集群。

    -   **迁移对象**：选择要迁移的对象，单击向右的箭头，将选中的对象添加到右侧。

        **说明：** 

        -   暂时不支持对系统表的迁移。
        -   目标集群中不能有和迁移对象同名的对象。将鼠标移至右侧框中的对象，单击**编辑**按钮，即可修改迁移后的对象名。
10. 单击右下角的**预检查并启动**，成功后单击**下一步**。

    如果预检查失败，可以点击具体检查项后的检查结果，查看具体的失败详情，并根据失败原因修复后，重新进行预检查。

11. 确认DTS购买信息，阅读并勾选**服务条款**，单击**立即购买并启动**。

    **说明：** 本迁移操作免费。

12. 单击目标地域，查看迁移状态。迁移完成时，状态为**已完成**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/17772/15574814959779_zh-CN.png)


